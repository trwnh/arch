#!/bin/bash

## after chrooting, run this
# curl https://github.com/trwnh/arch/blob/master/script/ux301.2 -o install
# chmod +x ./install
# ./install

ln -sf /usr/share/zoneinfo/America/Chicago /etc/localtime
hwclock --systohc
passwd
# (set root password)
useradd -m -g users -s /bin/bash trwnh
passwd trwnh
# (set user password)
sed -i '/#\s%wheel\sALL=(ALL)\sALL/s/^#//g' /etc/sudoers
echo "EDITOR=nano" > etc/environment
echo "ux301" > /etc/hostname
echo "127.0.0.1 localhost" > /etc/hosts
echo "::1 localhost" >> /etc/hosts 
echo "127.0.1.1 ux301.localdomain ux301" >> /etc/hosts
bootctl install
echo "title Arch Linux" > /boot/loader/entries/arch.conf
echo "linux /vmlinuz-linux" >> /boot/loader/entries/arch.conf
echo "initrd /intel-ucode.img" >> /boot/loader/entries/arch.conf
echo "initrd /initramfs-linux.img" >> /boot/loader/entries/arch.conf
echo "options root=LABEL=Arch rw" >> /boot/loader/entries/arch.conf
echo "default arch" > /boot/loader/loader.conf
echo "timeout 0" >> /boot/loader/loader.conf
echo "editor yes" >> /boot/loader/loader.conf
systemctl enable NetworkManager
systemctl enable systemd-timesyncd
sed -i '/#Color/s/^#//g' /etc/pacman.conf

rm ./install
