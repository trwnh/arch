#!/bin/bash
timedatectl set-ntp true

lsblk -f
read -p "Install on which drive? Give identifier in form /dev/sd_: " dev
parted $dev mklabel gpt
cgdisk $dev
mkfs.fat ${dev}1 -n "ESP"
mkfs.ext4 ${dev}2 -L "Arch"
lsblk -f
read -p "Does this look right? If so, type yes: " blkyes
if [ "$blkyes" = "yes" ]; then
  mount ${dev}2 /mnt
  mkdir /mnt/boot
  mount ${dev}1 /mnt/boot
  echo "Partitions mounted."
else
  echo "Let's try this again..."
  exit 1
fi

pacman -Sy
pacman -S reflector
reflector --country 'US' -p http --sort rate --save /etc/pacman.d/mirrorlist
pacstrap /mnt base base-devel
genfstab -U /mnt >> /mnt/etc/fstab
arch-chroot /mnt
