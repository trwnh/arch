#!/bin/bash
passwd

ln -sf /usr/share/zoneinfo/America/Chicago /etc/localtime
hwclock --systohc

echo "en_US.UTF-8 UTF-8
ar_JO.UTF-8 UTF-8" >> /etc/locale.gen
locale-gen
echo "LANG=en_US.UTF-8" > /etc/locale.conf
echo "Locales set and generated."

echo "x9dae" > /etc/hostname
echo "127.0.0.1 localhost
::1 localhost
127.0.1.1 x9dae.localdomain x9dae" >>/etc/hosts
systemctl enable dhcpcd
echo "Network settings loaded."

pacman -S intel-ucode linux-lts
bootctl install

#### Arch Linux bootloader entry
echo "title Arch Linux" > /boot/loader/entries/arch.conf
echo "linux /vmlinuz-linux" >> /boot/loader/entries/arch.conf
echo "initrd /intel-ucode.img" >> /boot/loader/entries/arch.conf
echo "initrd /initramfs-linux.img" >> /boot/loader/entries/arch.conf
echo "options root=LABEL=Arch rw" >> /boot/loader/entries/arch.conf

#### Arch Linux bootloader entry (fallback)
echo "title Arch Linux (fallback)" > /boot/loader/entries/arch-fallback.conf
echo "linux /vmlinuz-linux" >> /boot/loader/entries/arch-fallback.conf
echo "initrd /intel-ucode.img" >> /boot/loader/entries/arch-fallback.conf
echo "initrd /initramfs-linux-fallback.img" >> /boot/loader/entries/arch-fallback.conf
echo "options root=LABEL=Arch rw" >> /boot/loader/entries/arch-fallback.conf

#### Arch Linux bootloader entry (LTS)
echo "title Arch Linux (LTS)" > /boot/loader/entries/arch-lts.conf
echo "linux /vmlinuz-linux-lts" >> /boot/loader/entries/arch-lts.conf
echo "initrd /intel-ucode.img" >> /boot/loader/entries/arch-lts.conf
echo "initrd /initramfs-linux-lts.img" >> /boot/loader/entries/arch-lts.conf
echo "options root=LABEL=Arch rw" >> /boot/loader/entries/arch-lts.conf

#### Arch Linux bootloader entry (LTS fallback)
echo "title Arch Linux (LTS fallback)" > /boot/loader/entries/arch-lts.conf
echo "linux /vmlinuz-linux-lts" >> /boot/loader/entries/arch-lts.conf
echo "initrd /intel-ucode.img" >> /boot/loader/entries/arch-lts.conf
echo "initrd /initramfs-linux-lts-fallback.img" >> /boot/loader/entries/arch-lts.conf
echo "options root=LABEL=Arch rw" >> /boot/loader/entries/arch-lts.conf

#### EFI Shell v1 entry
echo "title EFI Shell v1" > /boot/loader/entries/efi1.conf
echo "efi /EFI/shellx64_v1.efi" >> /boot/loader/entries/efi1.conf

#### EFI Shell v2 entry
echo "title EFI Shell v2" > /boot/loader/entries/efi2.conf
echo "efi /EFI/shellx64_v2.efi" >> /boot/loader/entries/efi2.conf

#### Configure loaders
echo "default arch" > /boot/loader/loader.conf
echo "timeout 3" >> /boot/loader/loader.conf
echo "editor yes" >> /boot/loader/loader.conf

echo "EFI loaders created."
exit
cp /boot/EFI/shellx64_v1.efi /mnt/boot/EFI/shellx64_v1.efi
cp /boot/EFI/shellx64_v2.efi /mnt/boot/EFI/shellx64_v2.efi
echo "EFI Shells copied."
umount -R /mnt
echo "Partitions unmounted. You can now reboot."
